Для решения этой задачи, воспользуйтесь gtf-файлом , полученным в предыдущей задаче. В первой половине задачи мы с точностью до нуклеотида подсчитаем суммарное покрытие всех протеин-кодирующих регионов в нашей аннотации. Для этого, используя команды grep и awk,  мы сохраним все кодирующие интервалы из протеин-кодирующих генов (gene_type="protein_coding") в файле unmerged_CDS.bed. Помните, что формат bed использует нумерацию, начинающуюся с 0, а gtf - начинающуюся с 1, а также то, что gtf включает последний нуклеотид из заявленного интервала, а bed - нет. 
На следующей стадии, отсортируйте полученный ранее файл unmerged_CDS.bed . Назовите результат sorted_CDS.bed. Для сортировки можно использовать как bedtools sort, так и команду sort из Unix.
Далее, воспользуйтесь командой bedtools merge, чтобы слить вместе пересекающиеся интервалы. Полученный файл назовите merged_CDS.bed. Используя команду awk, подсчитайте, какое число нуклеотидов в нашей аннотации покрыто кодирующими последовательностями.
Во второй половине задачи мы проделаем те же операции для экзонов протеин-кодирующих генов.  Для этого, используя команды grep и awk,  мы сохраним все экзоны протеин-кодирующих генов (gene_type="protein_coding") в файле unmerged_exon.bed.
На следующей стадии, отсортируйте полученный ранее файл unmerged_exon.bed. Назовите результат sorted_exon.bed. Для сортировки можно использовать как bedtools sort, так и команду sort из Unix.
После этого воспользуйтесь командой bedtools merge, чтобы слить вместе пересекающиеся интервалы. Полученный файл назовите merged_exon.bed. Используя команду awk, посчитайте, какое число нуклеотидов покрыто экзонами протеин-кодирующих генов.
Наконец, подсчитайте, какой процент от экзонов протеин-кодирующих генов составляют кодирующие последовательности. Введите три числа через запятую, без пробелов: 1) число нуклеотидов, покрытых кодирующими последовательностями, 2) число нуклеотидов, покрытых экзонами протеин-кодирующих генов, 3) число процентов, которое кодирующие последовательности составляют от всех экзонов протеин-кодирующих генов (округленное до целого числа, без знака %). 
Подсказки: 1) протеин-кодирующие последовательности присутствуют не только в протеин-кодирующих генах. Будьте внимательны. 
2) чтобы лучше понимать операции, происходящие с файлами, загружайте в браузер IGV каждый новый полученный файл. Не забудьте выбрать правильную версию генома (H.sapiens, hg38).
3) Чтобы подсчитать сумму всех численных значений во второй колонке текстового файла file.txt, можно воспользоваться командой
awk '{sum+=$2} END {print sum}' file.txt
4) Чтобы распечатать через знак табуляции первую, вторую, и пятую колонки из текстового файла file.txt, можно воспользоваться командой 
awk '{print $1"\t"$2"\t"$5}' file.txt

Code:

grep 'gene_type "protein_coding"' gencode.v25.gtf | \

awk '{OFS="\t"; if($3=="CDS") print $1,$4-1,$5}' > unmerged_CDS.bed

bedtools sort -i unmerged_CDS.bed > sorted_CDS.bed

bedtools merge -i sorted_CDS.bed > merged_CDS.bed

awk '{sum += $3 - $2} END {print sum}' merged_CDS.bed

тоже самое для экзона, вместо cds искала exon
